<!DOCTYPE html>
<html>

<head>
    <title>MIXR</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!--CSS and Styles-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="genre-style.css" type="text/css" />
    <link rel="stylesheet" href="sidebar.css" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Monoton" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <!--JS and APIs-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBGVZFqzo2yJlvxgVaoNZH0bKSMjIoPA9c"></script>
    <script src = "index.js"> </script>
    <script src = "game.js"> </script>
    <script src = "sidebar.js"> </script>

    <script>
    function genQueryString(key, value) {
        var uri = "game.html";
        var re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
        var separator = uri.indexOf('?') !== -1 ? "&" : "?";
        if (uri.match(re)) {
            console.log(uri.replace(re, '$1' + key + "=" + value + '$2'));

            /* pass genre to some $.param  ? */

            location.href = uri.replace(re, '$1' + key + "=" + value + '$2');
            //return uri.replace(re, '$1' + key + "=" + value + '$2');
        } else {
            console.log(uri + separator + key + "=" + value);
            location.href = uri + separator + key + "=" + value;
            //return uri + separator + key + "=" + value;
        }

    }
    </script>
</head>

<body>
    <!--Navigation Bar-->
    <div id="navbar-wrapper">
        <nav class="navbar navbar-inverse">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">MIXR</a>
                </div>
                <div class="collapse navbar-collapse" id="myNavbar">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a data-toggle="modal" data-target=".leaderboardModal" href="#"><span class="glyphicon glyphicon-list-alt"></span> Leaderboard</a>
                            <div class="modal fade leaderboardModal" role="dialog">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                            <h2 class="modal-title">Leaderboard</h2>
                                        </div>
                                        <div class="modal-body">
                                            <table class="table table-inverse">
                                                <thead>
                                                    <tr>
                                                        <th>#</th>
                                                        <th>Username</th>
                                                        <th>Score</th>
                                                        <th>Location</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                        <li><a id="menu-toggle"  onclick="initializeLocation()" href="#"><span class="glyphicon glyphicon-user"></span> Account</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </div>
    <!--End of Top Nav Bar-->
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li class="sidebar-brand">
                    <li>
                        <img id="profile" src="images/guest.png" class="img-responsive" width="70" height="70">
                    </li>
                    <li>
                        <p id="name"> Guest </p>
                    </li>
                    <li>
                        <p id="score"> Score</p>
                    </li>
                    <li>
                        <p id="location"> Location </p>
                    </li>
                    <li>
                        <a id = "loginButton" href="#" onclick="fblogin()"><span class="glyphicon glyphicon-user"></span> Facebook Login</a>
                    </li>
                    <li>
                        <a id = "logoutButton" href="#" onclick="fblogout()"><span class="glyphicon glyphicon-off"></span> Facebook Logout</a>
                    </li>
                </li>
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container">
                <div class="page-title">
                    <h1> Choose Your Genre </h1>
                </div>
                <div class="row">
                    <div class="col-md-4" onclick="genQueryString('genre', 'pop')">
                        <img src="images/pop.jpg" class="img-responsive" alt="arianagrande" width="370" height="370">
                        <!-- add a class that identifies the images that we want to be able to click onclick
                        add class="genre" -->
                        <!-- on click you open game, then pass the arguments (genre == ?) In game
                        it shows what url was passed as an argument then you make the request
                        Pass the query part of the location object to a jquery method call $.param
                        pass location.query. this turns the parameters into an object. you can access
                        params.genre -->
                        <div class="overlay">
                            <h2> Pop </h2>
                        </div>
                    </div>
                    <div class="col-md-4" onclick="genQueryString('genre', 'hip-hop')">
                        <img src="images/hiphop.jpg" class="img-responsive" alt="frankocean" width="370" height="370">
                        <div class="overlay">
                            <h2> Hip hop </h2>
                        </div>
                    </div>
                    <div class="col-md-4" onclick="genQueryString('genre', 'punk')">
                        <img src="images/punkrock.jpg" class="img-responsive" alt="greenday" width="370" height="370">
                        <div class="overlay">
                            <h2> Punk Rock </h2>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4" onclick="genQueryString('genre', 'R%26B')">
                        <img src="images/r&b.jpg" class="img-responsive" alt="aliciakeys" width="370" height="370">
                        <div class="overlay">
                            <h2> Rhythm and Blues </h2>
                        </div>
                    </div>
                    <div class="col-md-4" onclick="genQueryString('genre', 'electronic')">
                        <img src="images/electronics.jpg" class="img-responsive" alt="daftpunk" width="370" height="370">
                        <div class="overlay">
                            <h2> Electronic dance </h2>
                        </div>
                    </div>
                    <div class="col-md-4" onclick="genQueryString('genre', 'country')">
                        <img src="images/country.jpg" class="img-responsive" alt="blake" width="370" height="370">
                        <div class="overlay">
                            <h2> Country </h2>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4" onclick="genQueryString('genre', 'latin')">
                        <img src="images/latin.jpg" class="img-responsive" alt="jbalvin" width="370" height="370">
                        <div class="overlay">
                            <h2> Latin </h2>
                        </div>
                    </div>
                    <div class="col-md-4" onclick="genQueryString('genre', 'rock')">
                        <img src="images/rock.jpg" class="img-responsive" alt="nirvana" width="370" height="370">
                        <div class="overlay">
                            <h2> Rock </h2>
                        </div>
                    </div>
                    <div class="col-md-4" onclick="genQueryString('genre', 'indiepop')">
                        <img src="images/indie.jpg" class="img-responsive" alt="dragons" width="370" height="370">
                        <div class="overlay">
                            <h2> Indie </h2>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>

    <script type="text/javascript">
        var Req = new XMLHttpRequest();
        var url = "https://musicguessing.herokuapp.com/leaders";

        Req.open("GET", url, true);
        Req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        Req.send();

        Req.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        myJSON = this.responseText;
                        myObj = JSON.parse(myJSON);

                        for (var i = 0; i < 10; i ++) {
                            username = myObj.topTen[i].username;
                            score = myObj.topTen[i].score;

                            var tr = "  <tr>\
                                        <th>" + i + "</th>\
                                        <td>" + username + "</td>\
                                        <td>" + score + "</td>\
                                        <td>" + score + "</td>\
                                        </tr>";
                            $('table tbody').append(tr);
                        }

                    }
                }
    </script>

    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");

        newScore = returnScore();
        $("#score").text(newScore);
    });
    </script>
</body>

</html>
